<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Profile | Medicare</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://cdn.jsdelivr.net/npm/daisyui@5" rel="stylesheet" type="text/css" />
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <!-- Add FontAwesome if not already present -->
  <script src="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/js/all.min.js"></script>
  
</head>
<body class="bg-base-100 min-h-screen">
  <!-- Navbar (reuse from shop.html) -->
  <nav class="navbar bg-base-200 shadow-sm rounded-b-xl px-4 py-2 flex flex-wrap items-center justify-between">
    <div class="flex items-center gap-2">
      <a href="/client/index.html" class="btn btn-ghost text-xl font-bold text-primary">Medicare</a>
      <a href="shop.html" class="btn btn-outline btn-sm ml-2">‚Üê Back to Shop</a>
    </div>
    <div class="flex-1 mx-4 max-w-md">
      <div class="relative w-full">
        <input type="search" class="input input-bordered w-full pl-4 pr-10" placeholder="Search medicines..." />
        <span class="absolute right-3 top-2.5 text-gray-400 text-lg">&#128269;</span>
      </div>
    </div>
    <div class="flex items-center gap-4">
      <button class="btn btn-ghost text-xl" onclick="window.location.href='cart.html'" title="View Cart">&#128722;</button>
      <!-- Notification Icon -->
      <button class="btn btn-ghost text-xl" onclick="window.location.href='notifications.html'" title="Notifications">
        <span class="relative">
          <i class="fa-solid fa-bell"></i>
          <span id="notifBadge" class="badge badge-error absolute -top-2 -right-2 text-xs" style="display:none;">!</span>
        </span>
      </button>
      <div class="dropdown dropdown-end">
        <label tabindex="0" class="avatar cursor-pointer">
          <div class="w-10 rounded-full border-2 border-primary">
            <img id="userAvatar" src="default.jpg" alt="User Avatar" />
          </div>
        </label>
        <ul tabindex="0" class="dropdown-content menu p-2 shadow bg-base-100 rounded-box w-40">
          <li><a href="/client/index.html">Logout</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Toast Notification -->
  <div id="toast" class="fixed top-6 left-1/2 -translate-x-1/2 z-50 hidden">
    <div id="toastMsg" class="alert shadow-lg transition-all duration-300"></div>
  </div>

  <!-- Delete Modal -->
  <dialog id="deleteModal" class="modal">
    <form method="dialog" class="modal-box">
      <h3 class="font-bold text-lg mb-2 text-error">Delete Account</h3>
      <p class="mb-4">Are you sure you want to delete your account? This action cannot be undone.</p>
      <div class="flex gap-4 justify-end">
        <button id="cancelDeleteBtn" class="btn btn-outline">Cancel</button>
        <button id="confirmDeleteBtn" class="btn btn-error">Delete</button>
      </div>
    </form>
    <form method="dialog" class="modal-backdrop">
      <button>close</button>
    </form>
  </dialog>

  <!-- Main Profile Section -->
  <div class="container mx-auto px-2 py-8">
    <div class="max-w-xl mx-auto card bg-base-100 shadow-md p-8">
      <div class="flex flex-col items-center gap-4 mb-6">
        <div class="avatar">
          <div class="w-24 rounded-full border-2 border-primary">
            <img id="profilePic" src="/client/assets/images/user-avatar.jpg" alt="User Avatar" />
          </div>
        </div>
        <div class="text-xl font-bold text-primary" id="profileName"></div>
        <div class="text-base text-gray-500" id="profileEmail"></div>
      </div>
      <form id="profileForm" class="flex flex-col gap-6 animate-fadein">
        <div class="form-control">
          <label class="label font-semibold" for="username">Username</label>
          <input type="text" id="username" class="input input-bordered w-full" required>
        </div>
        <div class="form-control">
          <label class="label font-semibold" for="email">Email</label>
          <input type="email" id="email" class="input input-bordered w-full" required>
        </div>
        <!-- <div class="form-control">
          <label class="label font-semibold" for="phone">Phone Number</label>
          <input type="tel" id="phone" class="input input-bordered w-full" required pattern="^07\\d{8}$">
        </div> -->
        <!-- <div class="form-control">
          <label class="label font-semibold" for="address">Delivery Address</label>
          <input type="text" id="address" class="input input-bordered w-full" required>
        </div> -->
        <div class="flex gap-4 mt-4">
          <button type="submit" class="btn btn-primary flex-1 transition-all duration-200">Save Changes</button>
          <button type="button" id="deleteBtn" class="btn btn-error flex-1 transition-all duration-200">Delete Account</button>
        </div>
      </form>
    </div>
  </div>

  <script src="../scripts/profile.js"></script>
  <script>
    // Set user avatar from localStorage
    (() => {
      try {
        const userData = localStorage.getItem('user');
        if (userData) {
          const user = JSON.parse(userData);
          const avatarEl = document.getElementById('userAvatar');
          if (avatarEl && user && user.profilePic) {
            avatarEl.src = user.profilePic;
          }
        }
      } catch (e) {
        // fallback: do nothing
      }
    })();
  </script>
</body>
</html>